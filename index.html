<!DOCTYPE html>
<html lang="en">
	<head>
		<title>Test 59</title>
		<meta charset="utf-8">
        <!--favicon -->
		<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
        <link rel="apple-touch-icon" sizes="180x180" href="../../css/favicon/apple-touch-icon.png">
        <link rel="icon" type="image/png" sizes="32x32" href="../../css/favicon/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="../../css/favicon/favicon-16x16.png">
        <link rel="manifest" href="../../css/favicon/site.webmanifest">
        <link rel="mask-icon" href="../../css/favicon/safari-pinned-tab.svg" color="#5bbad5">
        <meta name="msapplication-TileColor" content="#da532c">
        <meta name="theme-color" content="#ffffff">
        <!-- end favicon -->
        <style>
            body{
                margin: 0;
            }
        </style>
	</head>
	<body>
        <canvas id="movArea" width="200" height="100" style="border:1px solid #d3d3d3;">CANVAS NOT SUPPORTED</canvas>
        <p id="ACCELERATION_ID" style="text-shadow: 0 0 3px #fff, 0 0 5px #fff;"> ACCELERATION </p>
        <p id="WALKING_TIME_ID" style="text-shadow: 0 0 3px #fff, 0 0 5px #fff;"> WALKING TIME </p>
        <script>

            var threshold = 0.3;

            var walkingTime = 0;
            var accMagnitude;

            var canvas = document.getElementById("movArea");
            const context = canvas.getContext("2d");

            let gyroscope = new Gyroscope({frequency: 60});

            gyroscope.addEventListener('reading', (e) => {
                context.beginPath();
                context.translate(100, 50);
                context.rotate(1.15);
                context.moveTo(-25, -25);
                context.lineTo(0, 25);
                context.lineTo(25, -25);
                context.lineTo(-25, -25);
                context.stroke();
                context.closePath();
            });
            gyroscope.start();
            

            if (window.DeviceOrientationEvent) {
                window.ondevicemotion = function(event) {
                    var x = event.acceleration.x.toFixed(2);
                    var y = event.acceleration.y.toFixed(2);
                    var z = event.acceleration.z.toFixed(2);

                    accMagnitude = Math.sqrt(Math.pow(x, 2) + Math.pow(y, 2) + Math.pow(z, 2));

                    document.getElementById("ACCELERATION_ID").innerHTML = y + " ";
                };
            }
            else
            {
                alert("NO DEVICE ORIENTATION");
            }

            setInterval(function () {
                if (accMagnitude > threshold) walkingTime++;

                document.getElementById("WALKING_TIME_ID").innerHTML = walkingTime;
            }, 1000);

            function TakePicture()
            {
                if (walkingTime > 4)
                    alert("picture taken outside bounds");
                else
                    walkingTime = 0;
            }

        </script>

        <button id="button" onclick="TakePicture()">Take Picture</button>

	</body>
</html>
